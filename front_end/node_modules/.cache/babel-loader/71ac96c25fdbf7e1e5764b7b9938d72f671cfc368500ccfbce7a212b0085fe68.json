{"ast":null,"code":"var _jsxFileName = \"/Users/clemzouuu/Desktop/ESGI/ARCHI_1/PROJET_ANNUEL/UFC-QUE-CHOISIR/ufc/front_end/src/components/survey/SurveyResponse.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst SurveyResponse = ({\n  survey,\n  onSubmit\n}) => {\n  _s();\n  const [responses, setResponses] = useState(Array(survey.questions.length).fill(''));\n  const [isDeadlinePassed, setIsDeadlinePassed] = useState(false);\n  useEffect(() => {\n    const now = new Date();\n    const deadline = new Date(survey.deadline);\n    setIsDeadlinePassed(now > deadline);\n  }, [survey.deadline]);\n  const handleResponseChange = (qIndex, value) => {\n    const newResponses = [...responses];\n    newResponses[qIndex] = value;\n    setResponses(newResponses);\n  };\n  const handleSubmit = async () => {\n    if (!isDeadlinePassed) {\n      const userId = 1;\n      const surveyId = survey.id;\n      const responsePayload = {\n        surveyId: surveyId,\n        userId: userId,\n        responses: responses\n      };\n      try {\n        const token = localStorage.getItem('token');\n        const response = await axios.post('http://localhost:3000/survey-responses', {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          },\n          body: JSON.stringify(responsePayload)\n        });\n        if (response.ok) {\n          onSubmit(responses);\n          setResponses(Array(survey.questions.length).fill(''));\n        } else {\n          console.error('Erreur lors de la soumission des réponses');\n        }\n      } catch (error) {\n        console.error('Erreur lors de la soumission des réponses', error);\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: survey.title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), isDeadlinePassed ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Le d\\xE9lai pour r\\xE9pondre \\xE0 ce sondage est d\\xE9pass\\xE9.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [survey.questions.map((question, qIndex) => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: question.questionText\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 15\n        }, this), question.type === 'radio' ? question.options.map((option, oIndex) => /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"radio\",\n            name: `question-${qIndex}`,\n            value: option,\n            onChange: e => handleResponseChange(qIndex, e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 21\n          }, this), option]\n        }, oIndex, true, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 19\n        }, this)) : /*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: responses[qIndex],\n          onChange: e => handleResponseChange(qIndex, e.target.value),\n          placeholder: \"Votre r\\xE9ponse\",\n          rows: 4,\n          style: {\n            width: '100%',\n            padding: '10px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 17\n        }, this)]\n      }, qIndex, true, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 13\n      }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSubmit,\n        children: \"Soumettre les r\\xE9ponses\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, this);\n};\n_s(SurveyResponse, \"yLGJ2tchnV+R0dLANmAhflpyd5A=\");\n_c = SurveyResponse;\nexport default SurveyResponse;\nvar _c;\n$RefreshReg$(_c, \"SurveyResponse\");","map":{"version":3,"names":["React","useState","useEffect","axios","jsxDEV","_jsxDEV","Fragment","_Fragment","SurveyResponse","survey","onSubmit","_s","responses","setResponses","Array","questions","length","fill","isDeadlinePassed","setIsDeadlinePassed","now","Date","deadline","handleResponseChange","qIndex","value","newResponses","handleSubmit","userId","surveyId","id","responsePayload","token","localStorage","getItem","response","post","headers","body","JSON","stringify","ok","console","error","children","title","fileName","_jsxFileName","lineNumber","columnNumber","map","question","questionText","type","options","option","oIndex","name","onChange","e","target","placeholder","rows","style","width","padding","onClick","_c","$RefreshReg$"],"sources":["/Users/clemzouuu/Desktop/ESGI/ARCHI_1/PROJET_ANNUEL/UFC-QUE-CHOISIR/ufc/front_end/src/components/survey/SurveyResponse.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\ninterface SurveyQuestion {\n  questionText: string;\n  options?: string[];\n  type: 'radio' | 'text';\n}\n\ninterface Survey {\n  id: number;\n  title: string;\n  questions: SurveyQuestion[];\n  deadline: string;\n}\n\ninterface SurveyResponseProps {\n  survey: Survey;\n  onSubmit: (responses: string[]) => void;\n}\n\nconst SurveyResponse: React.FC<SurveyResponseProps> = ({ survey, onSubmit }) => {\n  const [responses, setResponses] = useState<string[]>(Array(survey.questions.length).fill(''));\n  const [isDeadlinePassed, setIsDeadlinePassed] = useState(false);\n\n  useEffect(() => {\n    const now = new Date();\n    const deadline = new Date(survey.deadline);\n    setIsDeadlinePassed(now > deadline);\n  }, [survey.deadline]);\n\n  const handleResponseChange = (qIndex: number, value: string) => {\n    const newResponses = [...responses];\n    newResponses[qIndex] = value;\n    setResponses(newResponses);\n  };\n\n  const handleSubmit = async () => {\n    if (!isDeadlinePassed) {\n      const userId = 1; \n      const surveyId = survey.id;\n      const responsePayload = {\n        surveyId: surveyId,\n        userId: userId,\n        responses: responses,\n      };\n\n      try { \n        const token = localStorage.getItem('token');\n        const response = await axios.post('http://localhost:3000/survey-responses', {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          },\n          body: JSON.stringify(responsePayload),\n        });\n\n        if (response.ok) {\n          onSubmit(responses);\n          setResponses(Array(survey.questions.length).fill(''));\n        } else {\n          console.error('Erreur lors de la soumission des réponses');\n        }\n      } catch (error) {\n        console.error('Erreur lors de la soumission des réponses', error);\n      }\n    }\n  };\n\n  return (\n    <div>\n      <h2>{survey.title}</h2>\n      {isDeadlinePassed ? (\n        <p>Le délai pour répondre à ce sondage est dépassé.</p>\n      ) : (\n        <>\n          {survey.questions.map((question, qIndex) => (\n            <div key={qIndex}>\n              <p>{question.questionText}</p>\n              {question.type === 'radio' ? (\n                question.options!.map((option, oIndex) => (\n                  <label key={oIndex}>\n                    <input\n                      type=\"radio\"\n                      name={`question-${qIndex}`}\n                      value={option}\n                      onChange={(e) => handleResponseChange(qIndex, e.target.value)}\n                    />\n                    {option}\n                  </label>\n                ))\n              ) : (\n                <textarea\n                  value={responses[qIndex]}\n                  onChange={(e) => handleResponseChange(qIndex, e.target.value)}\n                  placeholder=\"Votre réponse\"\n                  rows={4}\n                  style={{ width: '100%', padding: '10px' }}\n                />\n              )}\n            </div>\n          ))}\n          <button onClick={handleSubmit}>Soumettre les réponses</button>\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default SurveyResponse;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}