{"ast":null,"code":"var _jsxFileName = \"/Users/clemzouuu/Desktop/ESGI/ARCHI_1/PROJET_ANNUEL/UFC-QUE-CHOISIR/ufc/front_end/src/components/survey/SurveyResponse.tsx\",\n  _s = $RefreshSig$();\nimport axios from 'axios';\nimport React, { useState, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst SurveyResponse = ({\n  survey,\n  onSubmit\n}) => {\n  _s();\n  const [responses, setResponses] = useState(Array(survey.questions.length).fill(''));\n  const [isDeadlinePassed, setIsDeadlinePassed] = useState(false);\n  useEffect(() => {\n    const now = new Date();\n    const deadline = new Date(survey.deadline);\n    setIsDeadlinePassed(now > deadline);\n  }, [survey.deadline]);\n  const handleResponseChange = (qIndex, value) => {\n    const newResponses = [...responses];\n    newResponses[qIndex] = value;\n    setResponses(newResponses);\n  };\n  const handleSubmit = async () => {\n    if (!isDeadlinePassed) {\n      const token = localStorage.getItem('token');\n      const surveyId = survey.id;\n      const responsePayload = {\n        surveyId: surveyId,\n        responses: responses\n      };\n      try {\n        const response = await axios.post('http://localhost:3000/survey-responses', responsePayload, {\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        if (response.status === 201) {\n          onSubmit(responses);\n          setResponses(Array(survey.questions.length).fill(''));\n          alert(\"\");\n        } else {\n          var _response$data;\n          const errorMessage = ((_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.error) || 'Erreur lors de la soumission des réponses';\n          alert(errorMessage);\n        }\n      } catch (error) {\n        if (axios.isAxiosError(error)) {\n          var _error$response, _error$response$data;\n          const errorMessage = ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || 'Erreur lors de la soumission des réponses';\n          alert(errorMessage);\n        } else {\n          alert('Une erreur inconnue est survenue');\n        }\n      }\n    } else {\n      alert('Le délai pour répondre à ce sondage est dépassé.');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: survey.title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), isDeadlinePassed ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Le d\\xE9lai pour r\\xE9pondre \\xE0 ce sondage est d\\xE9pass\\xE9.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [survey.questions.map((question, qIndex) => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: question.questionText\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 15\n        }, this), question.type === 'radio' ? question.options.map((option, oIndex) => /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"radio\",\n            name: `question-${qIndex}`,\n            value: option,\n            onChange: e => handleResponseChange(qIndex, e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 21\n          }, this), option]\n        }, oIndex, true, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 19\n        }, this)) : /*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: responses[qIndex],\n          onChange: e => handleResponseChange(qIndex, e.target.value),\n          placeholder: \"Votre r\\xE9ponse\",\n          rows: 4,\n          style: {\n            width: '100%',\n            padding: '10px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 17\n        }, this)]\n      }, qIndex, true, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 13\n      }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSubmit,\n        children: \"Soumettre les r\\xE9ponses\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 5\n  }, this);\n};\n_s(SurveyResponse, \"yLGJ2tchnV+R0dLANmAhflpyd5A=\");\n_c = SurveyResponse;\nexport default SurveyResponse;\nvar _c;\n$RefreshReg$(_c, \"SurveyResponse\");","map":{"version":3,"names":["axios","React","useState","useEffect","jsxDEV","_jsxDEV","Fragment","_Fragment","SurveyResponse","survey","onSubmit","_s","responses","setResponses","Array","questions","length","fill","isDeadlinePassed","setIsDeadlinePassed","now","Date","deadline","handleResponseChange","qIndex","value","newResponses","handleSubmit","token","localStorage","getItem","surveyId","id","responsePayload","response","post","headers","status","alert","_response$data","errorMessage","data","error","isAxiosError","_error$response","_error$response$data","children","title","fileName","_jsxFileName","lineNumber","columnNumber","map","question","questionText","type","options","option","oIndex","name","onChange","e","target","placeholder","rows","style","width","padding","onClick","_c","$RefreshReg$"],"sources":["/Users/clemzouuu/Desktop/ESGI/ARCHI_1/PROJET_ANNUEL/UFC-QUE-CHOISIR/ufc/front_end/src/components/survey/SurveyResponse.tsx"],"sourcesContent":["import axios, { AxiosError } from 'axios';\nimport React, { useState, useEffect } from 'react';\n\ninterface SurveyQuestion {\n  questionText: string;\n  options?: string[];\n  type: 'radio' | 'text';\n}\n\ninterface Survey {\n  id: number;\n  title: string;\n  questions: SurveyQuestion[];\n  deadline: string;\n}\n\ninterface SurveyResponseProps {\n  survey: Survey;\n  onSubmit: (responses: string[]) => void;\n}\n\nconst SurveyResponse: React.FC<SurveyResponseProps> = ({ survey, onSubmit }) => {\n  const [responses, setResponses] = useState<string[]>(Array(survey.questions.length).fill(''));\n  const [isDeadlinePassed, setIsDeadlinePassed] = useState(false);\n\n  useEffect(() => {\n    const now = new Date();\n    const deadline = new Date(survey.deadline);\n    setIsDeadlinePassed(now > deadline);\n  }, [survey.deadline]);\n\n  const handleResponseChange = (qIndex: number, value: string) => {\n    const newResponses = [...responses];\n    newResponses[qIndex] = value;\n    setResponses(newResponses);\n  };\n\n  const handleSubmit = async () => {\n    if (!isDeadlinePassed) {\n      const token = localStorage.getItem('token');\n      const surveyId = survey.id;\n      const responsePayload = {\n        surveyId: surveyId,\n        responses: responses,\n      };\n  \n      try {\n        const response = await axios.post(\n          'http://localhost:3000/survey-responses',\n          responsePayload,\n          {\n            headers: {\n              'Content-Type': 'application/json',\n              'Authorization': `Bearer ${token}`\n            }\n          }\n        );\n  \n        if (response.status === 201) {\n          onSubmit(responses);\n          setResponses(Array(survey.questions.length).fill(''));\n          alert(\"\")\n        } else {\n          const errorMessage = response.data?.error || 'Erreur lors de la soumission des réponses';\n          alert(errorMessage);\n        }\n      } catch (error) {\n        if (axios.isAxiosError(error)) {\n          const errorMessage = error.response?.data?.error || 'Erreur lors de la soumission des réponses';\n          alert(errorMessage);\n        } else {\n          alert('Une erreur inconnue est survenue');\n        }\n      }\n    } else {\n      alert('Le délai pour répondre à ce sondage est dépassé.');\n    }\n  };\n  \n\n  return (\n    <div>\n      <h2>{survey.title}</h2>\n      {isDeadlinePassed ? (\n        <p>Le délai pour répondre à ce sondage est dépassé.</p>\n      ) : (\n        <>\n          {survey.questions.map((question, qIndex) => (\n            <div key={qIndex}>\n              <p>{question.questionText}</p>\n              {question.type === 'radio' ? (\n                question.options!.map((option, oIndex) => (\n                  <label key={oIndex}>\n                    <input\n                      type=\"radio\"\n                      name={`question-${qIndex}`}\n                      value={option}\n                      onChange={(e) => handleResponseChange(qIndex, e.target.value)}\n                    />\n                    {option}\n                  </label>\n                ))\n              ) : (\n                <textarea\n                  value={responses[qIndex]}\n                  onChange={(e) => handleResponseChange(qIndex, e.target.value)}\n                  placeholder=\"Votre réponse\"\n                  rows={4}\n                  style={{ width: '100%', padding: '10px' }}\n                />\n              )}\n            </div>\n          ))}\n          <button onClick={handleSubmit}>Soumettre les réponses</button>\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default SurveyResponse;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}