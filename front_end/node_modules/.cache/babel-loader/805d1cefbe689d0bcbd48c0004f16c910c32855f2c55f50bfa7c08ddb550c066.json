{"ast":null,"code":"var _jsxFileName = \"/Users/clemzouuu/Desktop/ESGI/ARCHI_1/PROJET_ANNUEL/UFC-QUE-CHOISIR/ufc/front_end/src/components/vote/VoteResponse.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst VoteResponse = ({\n  vote,\n  onSubmit\n}) => {\n  _s();\n  const [responses, setResponses] = useState(Array(vote.questions.length).fill(''));\n  const [isDeadlinePassed, setIsDeadlinePassed] = useState(false);\n  useEffect(() => {\n    const now = new Date();\n    const deadline = new Date(vote.deadline);\n    setIsDeadlinePassed(now > deadline);\n  }, [vote.deadline]);\n  const handleResponseChange = (qIndex, value) => {\n    const newResponses = [...responses];\n    newResponses[qIndex] = value;\n    setResponses(newResponses);\n  };\n  const handleSubmit = async () => {\n    if (!isDeadlinePassed) {\n      const token = localStorage.getItem('token');\n      const voteId = vote.id;\n      const responsePayload = {\n        voteId: voteId,\n        responses: responses\n      };\n      try {\n        const response = await axios.post('http://localhost:3000/vote-responses', responsePayload, {\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        if (response.status === 201) {\n          onSubmit(responses);\n          setResponses(Array(vote.questions.length).fill(''));\n          alert(\"Vote pris en compte !\");\n        } else {\n          var _response$data;\n          const errorMessage = ((_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.error) || 'Erreur lors de la soumission des réponses';\n          alert(errorMessage);\n        }\n      } catch (error) {\n        if (axios.isAxiosError(error)) {\n          var _error$response, _error$response$data;\n          const errorMessage = ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || 'Erreur lors de la soumission des réponses';\n          alert(errorMessage);\n        } else {\n          alert('Une erreur inconnue est survenue');\n        }\n      }\n    } else {\n      alert('Le délai pour répondre à ce vote est dépassé.');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: vote.title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Modalit\\xE9 de vote: \", vote.mode]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this), vote.comment && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Commentaire: \", vote.comment]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 24\n    }, this), isDeadlinePassed ? /*#__PURE__*/_jsxDEV(\"span\", {\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Le d\\xE9lai pour r\\xE9pondre \\xE0 ce vote est d\\xE9pass\\xE9.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 12\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 12\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [vote.questions.map((question, qIndex) => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: question.questionText\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 15\n        }, this), question.options.map((option, oIndex) => /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"radio\",\n            name: `question-${qIndex}`,\n            value: option.text,\n            onChange: e => handleResponseChange(qIndex, e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 19\n          }, this), option.text]\n        }, oIndex, true, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 17\n        }, this))]\n      }, qIndex, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 13\n      }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSubmit,\n        children: \"Soumettre les r\\xE9ponses\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 12\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 5\n  }, this);\n};\n_s(VoteResponse, \"B4F3TjgR0MDIrE8oJ3kN3+4hcGQ=\");\n_c = VoteResponse;\nexport default VoteResponse;\nvar _c;\n$RefreshReg$(_c, \"VoteResponse\");","map":{"version":3,"names":["React","useState","useEffect","axios","jsxDEV","_jsxDEV","Fragment","_Fragment","VoteResponse","vote","onSubmit","_s","responses","setResponses","Array","questions","length","fill","isDeadlinePassed","setIsDeadlinePassed","now","Date","deadline","handleResponseChange","qIndex","value","newResponses","handleSubmit","token","localStorage","getItem","voteId","id","responsePayload","response","post","headers","status","alert","_response$data","errorMessage","data","error","isAxiosError","_error$response","_error$response$data","children","title","fileName","_jsxFileName","lineNumber","columnNumber","mode","comment","map","question","questionText","options","option","oIndex","type","name","text","onChange","e","target","onClick","_c","$RefreshReg$"],"sources":["/Users/clemzouuu/Desktop/ESGI/ARCHI_1/PROJET_ANNUEL/UFC-QUE-CHOISIR/ufc/front_end/src/components/vote/VoteResponse.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\n\ninterface VoteQuestion {\n  questionText: string;\n  options: { id: number, text: string }[];\n}\n\ninterface Vote {\n  id: number;\n  title: string;\n  questions: VoteQuestion[];\n  mode: string;\n  comment?: string;\n  deadline: string;\n}\n\ninterface VoteResponseProps {\n  vote: Vote;\n  onSubmit: (responses: string[]) => void;\n}\n\nconst VoteResponse: React.FC<VoteResponseProps> = ({ vote, onSubmit }) => {\n  const [responses, setResponses] = useState<string[]>(Array(vote.questions.length).fill(''));\n  const [isDeadlinePassed, setIsDeadlinePassed] = useState(false);\n\n  useEffect(() => {\n    const now = new Date();\n    const deadline = new Date(vote.deadline);\n    setIsDeadlinePassed(now > deadline);\n  }, [vote.deadline]);\n\n  const handleResponseChange = (qIndex: number, value: string) => {\n    const newResponses = [...responses];\n    newResponses[qIndex] = value;\n    setResponses(newResponses);\n  };\n\n  const handleSubmit = async () => {\n    if (!isDeadlinePassed) {\n      const token = localStorage.getItem('token');\n      const voteId = vote.id;\n      const responsePayload = {\n        voteId: voteId,\n        responses: responses,\n      };\n\n      try {\n        const response = await axios.post(\n          'http://localhost:3000/vote-responses',\n          responsePayload,\n          {\n            headers: {\n              'Content-Type': 'application/json',\n              'Authorization': `Bearer ${token}`\n            }\n          }\n        );\n\n        if (response.status === 201) {\n          onSubmit(responses);\n          setResponses(Array(vote.questions.length).fill(''));\n          alert(\"Vote pris en compte !\");\n        } else {\n          const errorMessage = response.data?.error || 'Erreur lors de la soumission des réponses';\n          alert(errorMessage);\n        }\n      } catch (error) {\n        if (axios.isAxiosError(error)) {\n          const errorMessage = error.response?.data?.error || 'Erreur lors de la soumission des réponses';\n          alert(errorMessage);\n        } else {\n          alert('Une erreur inconnue est survenue');\n        }\n      }\n    } else {\n      alert('Le délai pour répondre à ce vote est dépassé.');\n    }\n  };\n\n  return (\n    <div>\n      <h2>{vote.title}</h2>\n      <p>Modalité de vote: {vote.mode}</p>\n      {vote.comment && <p>Commentaire: {vote.comment}</p>}\n      {isDeadlinePassed ? (\n        <span>\n           <p>Le délai pour répondre à ce vote est dépassé.</p>\n           <hr/>\n        </span>\n       \n      ) : (\n        <>\n          {vote.questions.map((question, qIndex) => (\n            <div key={qIndex}>\n              <p>{question.questionText}</p>\n              {question.options.map((option, oIndex) => (\n                <label key={oIndex}>\n                  <input\n                    type=\"radio\"\n                    name={`question-${qIndex}`}\n                    value={option.text}\n                    onChange={(e) => handleResponseChange(qIndex, e.target.value)}\n                  />\n                  {option.text}\n                </label>\n              ))}\n            </div>\n          ))}\n          <button onClick={handleSubmit}>Soumettre les réponses</button>\n           <hr/>\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default VoteResponse;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}